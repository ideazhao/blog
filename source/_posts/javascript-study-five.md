title: 征服javascript学习笔记（五）——引用类型Object和Array         
date: 2016-04-20
tags: [javascript]
categories: [JavaScript]
toc: true
---


## 写在前面

引用类型，前面的章节提到过，ES的变量类型，分为“基本类型”和“引用类型”。那么这里就开始介绍“引用类型”。

引用类型的值（对象）是引用类型的一个实例，在ES中，引用类型是一种数据结构，用于将数据和功能组织在一起，

如前所述，对象是某个特定引用类型的实例，新对象是使用new操作符后跟一个**构造函数**来创建。构造函数本身就是一个函数，只不过该函数是出于创建新对象的目的而定义的，如下：

	var perspon=new Object();


## Object类型

我们平时所看到的大多数引用类型值都是Object类型的实例，而且，Object也是ES中使用最多的一个类型。虽然Object的实例不具备多少功能，但对于在应用程序中存储和传输数据而言，它们确实是非常理想的选择。

创建Object实例的方式有两种：

**第一种**

使用new操作符后跟Object构造函数，如下所示：

	var person=new Object();
		person.name="idea";
		person.age=27;

**第二种**

使用对象字面量，是对象定义的一种简写形式，目的在于简化创建包含大量属性的对象的过程。比如，上例可以写成下面这样：

	var person={
		name:"idea",
		age:27
	}

如上所示，对象，属性，属性值，一目了然。但有一点需要提示的是，多个属性之间需要添加逗号，但最后一个属性后面的逗号不是可有可无，如果加了，会在IE7及更早版本和Opera中导致错误。

属性名也可以使用字符串，比如：

	var person={
		“name”:"idea",
		“age”:27
	}

另外还会出现留空的情况，比如：

	var person={}

则其只包含默认的属性和方法。

可以看出对象字面量的方法可读性更好，还给人有封装数据的感觉，实际上，如果你有一些实践经验，就会知道，字面量也是向函数传递大量可选参数的首选方式。

一般来说，访问对象属性时使用都是点表示法，不过js中也可以使用方括号表示法来访问对象的属性，在使用这种方法时，应该将要访问的属性以字符串的形式放在方括号中，如下所示：

	alert(person["name"]); // "idea"

从功能上看，这两种方法没有任何区别，但方括号方法有个优点，可以通过变量访问属性：

	var personName="name";
		alert(person[personName]); //"idea"

如果属性名中包含会导致语法错误的字符或者使用关键字或保留字，也可以使用方括号表示法，比如：

	person["first name"]="idea";

因为属性名中包含空格，所以不能使用点表示法访问，然而属性名中是允许包含非字母非数字的，这时候就可以用方括号法访问。

通常，除非必须，建议使用点表示法。

## Array类型

除了Object类型，Array类型是ES中最常用的类型。而且ES中的Array和其他语言当中有很大不同，它的每一项可以保存任何数据类型的数据，而且数组的大小可以动态调整。

创建数组的基本方式有两种。

**第一种**

	var colors=new Array();

若知道数组长度，可以这样：

	var colors=new Array(20);

还可以把数组的项直接写进去，像这样：

	var colors=new Array("green","blue","yellow");

给构造函数传递值也是可以创建一个数组的，不过分为数值和其他类型之分，比如：

	var colors=new Array(3)；   //创建了一个长度为3的数组
		var colors=new Array("green"); //创建了一个包含一项值为“green”的数组

另外，可以省略new操作符，比如：

	var colors=Array();

**第二种**

数组字面量，直接看例子：

	var numbers=[0,1,2,3,4];

会创建一个长度为5的数组。

创建完了，就需要对其进行操作，最基本的就是读取和设置，这时候，需要使用方括号加上数字索引，数组的数字索引从0开始。

比如：

	var colors=["red","blue"];
		alert(colors[1]);   //读取
		colors[0]="green";  //设置

访问的时候，如果索引值对于数组长度，则会返回undefined，读取的时候不能这样读，但是，设置的时候是可以的，比如，以上数组，可以这样

	colors[2]="orange";

这个时候，数组就会创建一项并重新计算长度，当然，不是必须紧邻，还可以

	colors[10]="orange";

那么，它就是一个长度为11的数组了，不过，中间的8个值为undefined。


**检测数组**

自从ES3做出规定，就出现了确定某个对象是不是数组的经典问题，对于一个全局作用域来书欧，使用instance操作符就能得到满意的结果，如下：

	if(value instanceof Array){}

但问题在于，它假定只有一个全局执行环境，若有多个，就存在两个以上不同版本的Array构造函数。

ES5新增了Array.isArray()方法，这个方法的目的是最终确定一个值到底是不是数组，而不管它是在哪个全局执行环境中创建的.如下：

	if(Array.isArray(value)){}

但使用此方法时要注意低版本浏览器的兼容性。

**转换方法**

toLocaleString(),toString(),valueOf()

第二个会返回以数组中的每一项用逗号分隔开的字符串，实际上是调用了每一项的toString()方法，第三个返回的还是数组，如果是直接alert()一个数组，由于alert()要接收字符串参数，所以它会在后台调用toString()方法，由此得到和toString()方法相同的结果。

而第一种方法经常会和后两种返回相同的值，但也不总是如此，它会对每一项调用toLocaleString()，而不是toString()。 

当然，除了这几种方法，还有一种更加灵活可控的方法，join(),比如这样：

	var colors=["red","green","blue"];
		alert(colors.join("."));

就会返回以点号隔开的字符串。

**栈方法**

栈的概念，学过计算机的应该都不陌生，就算没有学过，也会比较容易懂，因为圣后中太多这样的例子，LIFO(last in first out),通俗说就是后进先出，栈中的项有插入和删除的操作，且只发生在栈的顶部。对此，ES为数组提供了push()和pop()方法，以便实现栈的行为。

push()方法可以接收任意数量的参数，把它们逐个添加到数组末尾，并返回修改后数组的长度，pop()方法则从数组末尾移除最后一项，减少数组的length值，然后返回移除的项。

**队列方法**

和栈有所不同，队列是FIFO(first in first out),先进先出，在末尾添加项，从列表的前端移除，因为给末尾添加项已经有了方法，所以，现在只需要一个从数组前端取得项的方法——shift()，它能够移除数组中的第一项并返回该项，同时数组长度减1，除此之外，ES还为数组提供了一个unshift()方法，顾名思义，和shift()的用途相反：它能在数组前端添加任意个项并返回新数组的长度。因此，同时使用unshift()和pop()方法，可以从相反方向来模拟队列，即前端添加项，末端移除项。

**重排序方法**

数组中存在两个可以直接来重排序的方法：reverse()和sort()，前者用于反转，默认情况下，sort()方法按升序排列数组项，即最小的值位于最前面，最大的值排在后面，为了实现排序，sort()方法会调用每个数组项的toString()转型方法，然后比较得到的字符串，以确定如何排序，即使数组中的每一项都是数值，sort()方法比较的也是字符串。

如下：

	var values=[0,1,5,10,15];
		values.sort();
		alert(values); //0,1,10,15,5

可见，即使值的顺序没有问题，但sort()方法也根据测试字符串的结果改变原来的顺序。这种排序方法在很多情况下都不是最佳方案，因此sort()方法可以接收一个比较函数作为参数，以便我们指定哪个值位于哪个值的前面。

**操作方法**

ES为操作自己已经包含在数组中的项提供了很多方法。

concat()方法可以基于当前数组中的所有项创建一个新数组。具体来说，这个方法会先创建当前数组一个副本，然后将接收到的参数添加到这个副本的末尾，最后返回新构建的数组，在没有给concat()方法传递参数的情况下，它仅是复制当前数组，如果传递给concat()方法的是一或多个数组，则该方法会将这些数组中的每一项都添加到结果数组中。如果传递的值不是数组，这些值就会被简单添加到结果数组的末尾。下面例子：

	var colors=["red","green","blue"];
		var colors2=colors.concat("yellow",["black","brown"]);
		alert(colors2);   //red,green,blue,yellow,black,brown

slice()方法,它能够基于当前数组中的一或多个项创建一个新数组，slice()方法可以接受一或两个参数，即要返回项的起始和结束位置。在只有一个参数的情况下，slice()方法返回从该参数指定位置开始到当前数据末尾的所有项。如果有两个参数，该方法返回起始和结束位置之间的项——但不包括结束位置的项。注意，slice()方法不会影响原始数组。

	var colors=["red","green","blue",“yellow”,"purple"];
		var colors2=colors.slice(1,4);
		alert(colors2); //green,blue,yellow

其参数可以为负，如果是负值，则用数组长度加上该数来确定相应的位置，如果结束位置小于起始位置，则返回空数组。

splice()方法，此方法是最强大的数组方法，有很多用法，主要用途是向数组中部插入项，但使用这种方法的方式有如下3种：

1、删除，可删除任意数量的项，只需要指定两个参数，要删的第一项的位置和删除的项数。
2、插入，向指定位置插入任意数量的项，需提供3个参数：起始位置、要删除的项数和要插入的项，如果要插入多个项，可以再传入第四、第五或更多的项。
3、替换，向指定位置插入任意数量的项，且同时删除任意数量的项，只需指定三个参数：起始位置、要删除的项数和要插入的任意数量的项。插入的项数不必与删除的项数相等。

splice()方法始终都会返回一个数组，该数组中包含从原始数组中删除的项(如果没有删除任何一项，则返回一个空数组)。

**位置方法**

ES5为数组实例添加了两个位置方法：indexOf()和lastIndexOf()，两个方法都接收两个参数：要查找的项表示查找起点位置的索引，其中，indexOf()方法从数组的开头开始向后查找，lastIndexOf()方法则从数组的末尾开始向前查找。如果没有找到，返回-1.

**迭代方法**

ES5为数组定义了5个迭代方法，每个方法都接收两个参数：要运行的函数和运行该函数的作用域对象。传入这些方法中的函数会接收三个参数：数组项的值，该项在数组中的位置和数组对象本身。作用分别如下：

every()

对数组中每一项运行给定函数，如果每一项都返回true，则返回true。

filter()

如其名，有过滤的作用，对数组每一项执行给定函数，返回结果为true的项组成的数组。

forEach()

对数组每一项运行指定函数，没有返回值。

map()

对每一项运行指定函数，返回每次函数调用结果组成的数组。

some()

每一项运行指定函数，如有任一项返回true，则返回true


**归并方法**


ES5新增了两个归并数组的方法：reduce()和reduceRight()。这两个方法都会迭代数组的所有项，然后构建一个最终返回的值，其中，reduce()方法从第一项开始，逐个遍历到最后，reduceRight()是从最后一项开始，向前遍历到第一项。这两个方法都接收两个参数：一个在每项上调用的函数和作为归并基础的初始值（可选的）。传给reduce()和reduceRight()的函数接收4个参数：前一个值、当前值，项的索引和数组对象。这个函数返回的任何值都会作为第一个参数自动传给下一项。

## 小结

至此，对Object类型和Array类型有了个简要的介绍和概览，可以有个初步的了解。要掌握和灵活运用它们，还需更多实践。后面会继续讨论其他引用类型。一起加油，一起进步吧~